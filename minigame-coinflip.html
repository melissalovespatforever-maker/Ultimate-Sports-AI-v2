<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ultimate Horse Racing ğŸ</title>
<style>
body{
  background:#050b1e;
  font-family:Arial;
  color:#eaffff;
  text-align:center;
  margin:0;
}
canvas{
  background:#08162e;
  border-radius:20px;
  box-shadow:0 0 35px #00ffff55;
  margin:12px auto;
  display:block;
}
.panel{
  width:420px;
  margin:auto;
  background:#0b1d33;
  padding:12px;
  border-radius:14px;
}
select,input,button{
  width:95%;
  padding:10px;
  margin-top:6px;
  border-radius:8px;
  border:none;
}
button{
  background:linear-gradient(135deg,#ffd700,#ffb300);
  font-weight:bold;
}
#announcer{
  margin-top:10px;
  color:#00ffff;
  min-height:22px;
  text-shadow:0 0 10px #00ffff99;
}
</style>
</head>

<body>

<h2>ğŸ Ultimate Horse Racing</h2>
<canvas id="race" width="560" height="380"></canvas>

<div class="panel">
ğŸ’° Balance: $<span id="bal">1000</span><br>

Horse:
<select id="pick"></select>

Bet:
<input id="bet" type="number" value="100">

<div id="odds"></div>

<button onclick="startRace()">START RACE</button>
</div>

<div id="announcer"></div>

<script>
const canvas = document.getElementById("race");
const ctx = canvas.getContext("2d");
const announcer = document.getElementById("announcer");
const bal = document.getElementById("bal");
const oddsBox = document.getElementById("odds");
const pick = document.getElementById("pick");

let balance=1000;
let racing=false;
let camX=0;
const finish=2600;
let lastLeader=-1;

const horseData=[
 {name:"Midnight Comet",color:"#00eaff",burst:0.3},
 {name:"Golden Hoof",color:"#ffd700",burst:0.6},
 {name:"Iron Thunder",color:"#ff4444",burst:0.4},
 {name:"Neon Mirage",color:"#ff55ff",burst:0.7},
 {name:"Shadow Fang",color:"#aaaaaa",burst:0.2},
 {name:"Solar Blaze",color:"#ff8800",burst:0.5}
];

const horses=[];

horseData.forEach((h,i)=>{
  horses.push({
    ...h,
    id:i,
    x:0,
    y:70+i*50,
    speed:1.6+Math.random()*1.4,
    stamina:100+Math.random()*70,
    rating:0,
    frame:0,
    finished:false
  });
  pick.innerHTML+=`<option value="${i}">${h.name}</option>`;
});

function calcOdds(){
  let total=0;
  horses.forEach(h=>{
    h.rating=h.speed*h.stamina;
    total+=h.rating;
  });
  oddsBox.innerHTML="<b>ğŸ“Š ODDS</b><br>";
  horses.forEach(h=>{
    h.odds=(total/h.rating).toFixed(2);
    oddsBox.innerHTML+=`${h.name}: ${h.odds}x<br>`;
  });
}
calcOdds();

function announce(t){ announcer.textContent=t; }

function drawHorse(h){
  const x=h.x-camX+70;
  const y=h.y;
  const leg=Math.sin(h.frame*0.4)*6;

  ctx.save();
  ctx.translate(x,y);

  // glow
  ctx.shadowColor=h.color;
  ctx.shadowBlur=18;

  // body
  ctx.fillStyle=h.color;
  ctx.beginPath();
  ctx.ellipse(0,0,24,12,0,0,Math.PI*2);
  ctx.fill();

  // head
  ctx.beginPath();
  ctx.arc(26,-4,8,0,Math.PI*2);
  ctx.fill();

  // mane
  ctx.fillStyle="#000";
  ctx.fillRect(-18,-12,10,4);

  // legs
  ctx.strokeStyle="#000";
  ctx.lineWidth=3;
  ctx.beginPath();
  ctx.moveTo(-10,10);
  ctx.lineTo(-10,16+leg);
  ctx.moveTo(0,10);
  ctx.lineTo(0,16-leg);
  ctx.moveTo(10,10);
  ctx.lineTo(10,16+leg);
  ctx.stroke();

  ctx.restore();
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // track
  ctx.fillStyle="#113322";
  ctx.fillRect(0,240,canvas.width,140);

  // finish line
  ctx.fillStyle="#fff";
  ctx.fillRect(finish-camX,0,6,canvas.height);

  horses.forEach(drawHorse);
}

function update(){
  let lead=0, leader=null;

  horses.forEach(h=>{
    if(h.finished)return;

    let pace=h.speed;
    if(Math.random()<h.burst*0.02) pace+=1.6;

    if(h.stamina<40) pace*=0.7;

    h.x+=pace;
    h.stamina-=0.15;
    h.frame++;

    if(h.x>lead){
      lead=h.x;
      leader=h;
    }

    if(h.x>=finish){
      h.finished=true;
      if(racing) finishRace(h);
    }
  });

  if(leader && leader.id!==lastLeader){
    announce(`${leader.name} takes the lead!`);
    lastLeader=leader.id;
  }

  camX=lead-140;
}

function loop(){
  if(!racing)return;
  update();
  draw();
  requestAnimationFrame(loop);
}

function startRace(){
  if(racing)return;
  const bet=+document.getElementById("bet").value;
  if(bet<=0||bet>balance)return;

  balance-=bet;
  bal.textContent=balance;

  horses.forEach(h=>{
    h.x=0;
    h.stamina=100+Math.random()*70;
    h.finished=false;
  });

  lastLeader=-1;
  racing=true;
  announce("ğŸ They're off and racing!");
  loop();
}

function finishRace(winner){
  racing=false;
  const bet=+document.getElementById("bet").value;
  const choice=+pick.value;

  if(winner.id===choice){
    const payout=Math.floor(bet*winner.odds);
    balance+=payout;
    announce(`ğŸ† ${winner.name} wins! +$${payout}`);
  }else{
    announce(`âŒ ${winner.name} wins the race.`);
  }

  bal.textContent=balance;
  calcOdds();
}
</script>

</body>
</html>
