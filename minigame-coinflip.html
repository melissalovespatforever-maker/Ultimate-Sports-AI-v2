<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Bot Racing (Clean)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{
  margin:0;
  background:#050a18;
  overflow:hidden;
  font-family:Arial,Helvetica,sans-serif;
}
canvas{display:block;}
#ui{
  position:absolute;
  bottom:12px;
  left:50%;
  transform:translateX(-50%);
  width:280px;
  background:rgba(10,20,40,.95);
  padding:12px;
  border-radius:14px;
  box-shadow:0 0 20px #00ffff66;
  color:#00ffff;
}
button,input,select{
  width:100%;
  margin-top:6px;
  padding:8px;
  border:none;
  border-radius:10px;
}
button{
  background:linear-gradient(135deg,#00ffff,#0088ff);
  font-weight:bold;
}
#log{text-align:center;margin-top:8px;min-height:20px;}
#finish{
  position:absolute;
  top:40%;
  left:50%;
  transform:translateX(-50%);
  font-size:56px;
  color:white;
  text-shadow:0 0 30px #00ffff;
  opacity:0;
}
</style>
</head>

<body>

<canvas id="canvas"></canvas>
<div id="finish">FINISH!</div>

<div id="ui">
Balance: $<span id="balance">1000</span>

<select id="track">
  <option value="0">NEON CIRCUIT</option>
  <option value="1">LAVA RUN</option>
</select>

<select id="bot">
  <option value="0">NEON-X</option>
</select>

<input id="bet" type="number" value="100">

<button id="start">START RACE</button>
<div id="log"></div>
</div>

<script>
/* =========================
   CANVAS SETUP
========================= */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize",resize);
resize();

/* =========================
   GAME STATE
========================= */
let balance = 1000;
let racing = false;
let cameraX = 0;

const tracks = [
  { name:"NEON CIRCUIT", length:1800, color:"#00ffff" },
  { name:"LAVA RUN", length:2000, color:"#ff5533" }
];

const bots = [
  { name:"NEON-X", color:"#00ffff", speed:2.6, wins:0 }
];

let racers = [];
let activeTrack = tracks[0];

/* =========================
   UI ELEMENTS
========================= */
const balEl = document.getElementById("balance");
const logEl = document.getElementById("log");
const finishEl = document.getElementById("finish");
const startBtn = document.getElementById("start");

/* =========================
   START RACE
========================= */
startBtn.onclick = () => {
  if(racing) return;

  const bet = Number(document.getElementById("bet").value);
  if(bet <= 0 || bet > balance){
    logEl.textContent = "Invalid bet";
    return;
  }

  balance -= bet;
  balEl.textContent = balance;
  finishEl.style.opacity = 0;

  activeTrack = tracks[
    Number(document.getElementById("track").value)
  ];

  racers = bots.map((b,i)=>({
    name:b.name,
    color:b.color,
    speed:b.speed,
    x:0,
    y:canvas.height*0.45 + i*80,
    trail:[],
    finished:false
  }));

  cameraX = 0;
  racing = true;
  logEl.textContent = "üèÅ Race started";
};

/* =========================
   UPDATE
========================= */
function update(){
  if(!racing) return;

  let leader = racers[0];

  racers.forEach(r=>{
    if(r.finished) return;

    r.x += r.speed + Math.random()*0.5;
    r.trail.push({x:r.x,y:r.y});
    if(r.trail.length > 12) r.trail.shift();

    if(r.x > leader.x) leader = r;

    if(r.x >= activeTrack.length){
      r.finished = true;
      racing = false;
      balance += 200;
      balEl.textContent = balance;
      finishEl.style.opacity = 1;
      logEl.textContent = `üèÜ ${r.name} wins!`;
    }
  });

  cameraX += (leader.x - cameraX - 200)*0.08;
}

/* =========================
   DRAW
========================= */
function draw(){
  ctx.fillStyle = "#050a18";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // lanes
  for(let i=0;i<4;i++){
    ctx.fillStyle = i%2 ? "#081020" : "#0b162c";
    ctx.fillRect(0,canvas.height*0.4+i*80,canvas.width,80);
  }

  racers.forEach(r=>{
    const px = r.x - cameraX + 200;

    // trail
    r.trail.forEach((t,i)=>{
      ctx.fillStyle = r.color + "55";
      ctx.beginPath();
      ctx.arc(t.x-cameraX+200,t.y,6-i*0.4,0,Math.PI*2);
      ctx.fill();
    });

    // glow
    ctx.shadowBlur = 20;
    ctx.shadowColor = r.color;

    ctx.fillStyle = r.color;
    ctx.beginPath();
    ctx.arc(px,r.y,14,0,Math.PI*2);
    ctx.fill();
    ctx.shadowBlur = 0;
  });

  // finish line
  ctx.fillStyle = activeTrack.color;
  ctx.fillRect(activeTrack.length-cameraX+200,0,5,canvas.height);
}

/* =========================
   LOOP (ALWAYS RUNS)
========================= */
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
